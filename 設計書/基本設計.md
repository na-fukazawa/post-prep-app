# ライブ告知 半自動投稿アプリ 基本設計書（v1）

## 1. 目的・範囲

要件定義に基づき、v1で実装する機能・画面・データ・通知・外部連携の基本仕様を定義する。

対象：iOS / Android（Flutter想定）

---

## 2. 前提・用語

* 告知：ライブ告知の投稿単位
* 投稿：SNSアプリ側でユーザーが最終確定する操作
* v1は「半自動投稿」。自動投稿は行わない

---

## 3. 機能一覧（v1）

* 告知データ管理（作成/編集/一覧/詳細）
* 告知ステータス管理（下書き/予約済み/投稿済み/投稿失敗）
* 端末ローカル通知
* X投稿支援（Web Intent起動）
* Instagram投稿支援（コピー・共有）
* スマート入力（貼り付け文章から自動抽出）
* キャプション生成 / 再生成
* テンプレート / ハッシュタグ管理
* カレンダー表示
* 設定（通知ON/OFF、デフォルトSNS、テンプレート）

---

## 4. 画面設計

### 4.1 S-01 告知一覧画面

**目的**  
告知の状況を一覧で把握し、次の操作に迷わず進める。

**主なUI要素**

* 告知カード/リスト
  * 告知タイトル
  * 公開日時
  * 対象SNS（X / Instagram）
  * ステータス（下書き/予約済み/投稿済み/投稿失敗）
* 新規作成ボタン（＋）

**操作/遷移**

* 告知タップ → S-03 告知詳細
* 新規作成 → S-02 告知作成・編集

**空状態**

* 告知が0件の場合は「新規作成を促す文言」を表示

---

### 4.2 S-02 告知作成・編集画面

**目的**  
投稿内容と公開日時を事前に完成させる。

**入力項目**

* 告知タイトル（必須）
* 本文（必須）
* 関連URL（任意）
* 画像（複数可）
* イベント詳細（任意）
  * 日付
  * 開場
  * 開演
  * 会場
  * 出演者（複数）
* チケット情報（任意）
  * 料金
  * 予約URL
* ハッシュタグ（複数）
* 公開日時（必須）
* 投稿対象SNS（X / Instagram、複数可）
* スマート入力（貼り付け文章から自動抽出）
* キャプション生成 / 再生成

**操作**

* 下書き保存
* 公開予約（保存）

**入力制約（基本）**

* 必須項目の未入力時は保存不可
* 公開日時が現在時刻以前の場合は警告

**保存時のステータス**

* 下書き保存 → 下書き
* 公開予約 → 予約済み（通知登録）

---

### 4.3 S-03 告知詳細画面

**目的**  
通知後のハブ画面として、即投稿に入れる状態を作る。

**表示内容**

* 告知タイトル
* 本文（全文表示、コピー可）
* 画像プレビュー（複数）
* 公開日時
* 対象SNS

**操作**

* 本文コピー
* 画像保存 / 共有
* 「Xで投稿する」ボタン
* 「Instagram投稿ガイド」表示
* 「投稿完了としてマーク」

**ステータス変更**

* 投稿完了はユーザー操作で明示（「投稿済み」マーク）

---

### 4.4 S-04 設定画面

**目的**  
通知・デフォルト設定を変更する。

**項目**

* 通知ON/OFF
* デフォルト投稿SNS
* デフォルトハッシュタグ
* キャプションテンプレート
* AIトーン設定

**操作**

* 変更内容の保存

---

### 4.5 S-05 カレンダー画面

**目的**  
告知の公開日時をカレンダーで把握する。

**主なUI要素**

* 月表示カレンダー
* 告知のある日付マーカー
* 選択日の告知一覧

**操作/遷移**

* 日付タップ → 当日の告知一覧を表示
* 告知タップ → S-03 告知詳細

---

## 5. 画面遷移

画面遷移は `設計書/画面遷移図.md` に従う。

---

## 6. データ設計（ローカル）

### 6.1 告知データ（Announcement）

| フィールド | 型 | 必須 | 概要 |
| --- | --- | --- | --- |
| id | string | ○ | UUID |
| title | string | ○ | 告知タイトル |
| body | string | ○ | SNS投稿本文 |
| url | string | - | 関連URL |
| images | list<string> | - | 画像パス/URI |
| publishAt | datetime | ○ | 公開日時 |
| targets | list<string> | ○ | 投稿対象（X/Instagram） |
| status | string | ○ | 下書き/予約済み/投稿済み/投稿失敗 |
| eventDate | date | - | 開催日 |
| openTime | time | - | 開場 |
| startTime | time | - | 開演 |
| venue | string | - | 会場 |
| performers | list<string> | - | 出演者 |
| ticketPrice | number | - | 料金 |
| ticketUrl | string | - | 予約URL |
| hashtags | list<string> | - | ハッシュタグ |
| createdAt | datetime | ○ | 作成日時 |
| updatedAt | datetime | ○ | 更新日時 |

### 6.2 設定データ（Settings）

| フィールド | 型 | 必須 | 概要 |
| --- | --- | --- | --- |
| notificationsEnabled | bool | ○ | 通知ON/OFF |
| defaultTargets | list<string> | - | デフォルト投稿対象 |
| defaultHashtags | list<string> | - | デフォルトハッシュタグ |
| captionTemplate | string | - | キャプションテンプレート |
| aiTone | string | - | キャプション生成トーン |

---

## 7. 通知設計

* 公開日時にローカル通知を登録
* 通知文言：告知タイトル + 固定文言（例：「投稿の時間です」）
* 通知タップ → 該当告知の詳細画面へ遷移

---

## 8. 外部連携

### 8.1 X（v1完成形）

* Web Intentで投稿画面を起動
* 本文 + URL を自動入力
* ユーザーが投稿確定

### 8.2 Instagram（v1半自動）

* 本文コピー/画像共有でユーザーを支援
* アプリ内からInstagramの投稿画面に遷移（共有）

---

## 9. 権限

* 画像アクセス（端末ギャラリー/ストレージ）
* 通知権限（iOS/Android）

---

## 10. エラー/例外

* 通知権限が拒否された場合は、設定画面で再案内
* 画像読み込み失敗時はプレースホルダー表示
* X/Instagramが未インストールの場合は、ストア誘導または共有シートで代替
* 共有/外部アプリ起動失敗時は「投稿失敗」に遷移し、再試行を提示

---

## 11. 非機能要件（抜粋）

* 操作回数は最小限
* 将来の自動投稿に備えたデータ構造

---

以上
